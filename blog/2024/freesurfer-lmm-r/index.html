<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>


<title>Setting up a Freesurfer LMM through R - Dr. Mowinckel&#39;s</title>


<meta name="hugo-igloo" />




  <meta name="description" content="Running Freesurfer Linear Mixed Models on vertex-vise data is a
popular way of capturing more advanced statistical models in
neuroimaging. In this post I highlight how you can prepare your
data in R for Freesurfer LMMs." />
  <meta name="author" content="Dr. Mowinckel" />






<meta name="generator" content="Hugo 0.119.0">



        

<meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://drmowinckels.io/">
<meta prefix="og: http://ogp.me/ns#" property="og:type" content="website">
<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Setting up a Freesurfer LMM through R - Dr. Mowinckel&rsquo;s">
<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Running Freesurfer Linear Mixed Models on vertex-vise data is a
popular way of capturing more advanced statistical models in
neuroimaging. In this post I highlight how you can prepare your
data in R for Freesurfer LMMs.">


<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:domain" content="https://drmowinckels.io/">
<meta name="twitter:title" content="Igloo">
<meta name="twitter:description" content="Running Freesurfer Linear Mixed Models on vertex-vise data is a
popular way of capturing more advanced statistical models in
neuroimaging. In this post I highlight how you can prepare your
data in R for Freesurfer LMMs.">



    <meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://drmowinckels.io/blog/2024/freesurfer-lmm-r/index_files/figure-html/featured-1.png" />
    <meta name="twitter:image" content="https://drmowinckels.io/blog/2024/freesurfer-lmm-r/index_files/figure-html/featured-1.png">



        
  





    



 

    <link rel="stylesheet" href="https://drmowinckels.io/bundle.min.b949f82ef13ab020c09cc9a01a06b5c35de205c6382cde6ed472ebf5efc8e9d2.css" 
    integrity="sha256-uUn4LvE6sCDAnMmgGga1w13iBcY4LN5u1HLr9e/I6dI=" 
    crossorigin="anonymous">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/night-owl.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>



    <script src="https://drmowinckels.io/uikit/dist/js/uikit.min.js"></script>


    <script src="https://drmowinckels.io/uikit/dist/js/uikit-icons.min.js"></script>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha384-k6Rqe5g0pSv8V0e6fFfFjW1y77vKTjkE1IUaB+MHUO2GtODX6azbMqa6Y53/zJTU" crossorigin="anonymous">

        



    

    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_16x0_resize_box_3.png"
        sizes="16x16"
        type="image/png"
    />
    
    
    
        
        <link rel="shortcut icon" href="https://drmowinckels.io/favicon.ico" type="image/x-icon">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_32x0_resize_box_3.png"
        sizes="32x32"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_57x0_resize_box_3.png"
        sizes="57x57"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_76x0_resize_box_3.png"
        sizes="76x76"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_96x0_resize_box_3.png"
        sizes="96x96"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_128x0_resize_box_3.png"
        sizes="128x128"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_120x0_resize_box_3.png"
        sizes="120x120"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_150x0_resize_box_3.png"
        sizes="150x150"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_152x0_resize_box_3.png"
        sizes="152x152"
        type="image/png"
    />
    
    
    
        <meta name="msapplication-TileImage" 
            content="/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_144x0_resize_box_3.png">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_144x0_resize_box_3.png"
        sizes="144x144"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_180x0_resize_box_3.png"
        sizes="180x180"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_192x0_resize_box_3.png"
        sizes="192x192"
        type="image/png"
    />
    
    
    
    <link
        rel="shortcut icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_196x0_resize_box_3.png"
        sizes="196x196"
        type="image/png"
    />
<meta name="msapplication-TileColor" content="#198c8c">
<meta name="theme-color" content="#198c8c"> 
<meta name="msapplication-TileColor" content="#198c8c">

    </head>
    <body>
            
<div class="banner ">
    
        <div class="uk-container uk-container-small banner-top">
            <h1>blog</h1>
        </div>
    
</div>

        



<div id="smallnav" uk-offcanvas="flip: true" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">
        <ul class="uk-nav">
            
                <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                    <img src="https://drmowinckels.io/img/logo.png" width="40">
                </a> 
            
            
                <li>
                    <a href="https://drmowinckels.io/about">
                        About
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/blog">
                        Blog
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/talks">
                        Talks
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/projects">
                        Projects
                        
                    </a>
                    
                </li>
            
        </ul>
    </div>
</div>
<a class="uk-navbar-container uk-navbar-left uk-navbar-toggle uk-hidden@s" uk-toggle="target: #smallnav" uk-navbar-toggle-icon></a>

<div class="uk-visible@s" uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky">
    <nav class="uk-navbar-container">   
        <div uk-navbar>     
            <div class="uk-navbar-center">
                
                    
                        <div class="uk-navbar-center-left">
                            <ul class="uk-navbar-nav">
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/about">
                            About
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/blog">
                            Blog
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
                    
                    
                        
                            <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                                <img src="https://drmowinckels.io/img/logo.png" width="40">
                            </a> 
                        
                        <div class="uk-navbar-center-right">
                            <ul class="uk-navbar-nav"> 
                    
                    <li>
                        <a href="https://drmowinckels.io/talks">
                            Talks
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/projects">
                            Projects
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
            </div>
        </div>
    </nav>
</div>


        <div id="content" class="uk-container uk-container-small uk-margin-large-top">
    <article class="uk-article">
        <div class="uk-grid uk-flex-top" uk-grid>
            
            
            <div class="uk-width-1-4@s">
              <img src="https://drmowinckels.io/blog/2024/freesurfer-lmm-r/index_files/figure-html/featured-1.png" alt="Setting up a Freesurfer LMM through R" class="uk-border-rounded">
              
            </div>

        <div class="uk-width-3-4@s">
        <h1 class="uk-article-title">Setting up a Freesurfer LMM through R</h1>
        
        <div class="uk-border-top uk-article-meta uk-flex uk-flex-center uk-flex-between">
            <h3 class="uk-margin-top-small">
                Mar 1, 2024
            </h3>
            

            
                <div class="uk-flex uk-flex-wrap uk-flex-right">
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/r/" class="uk-label uk-label-secondary tags" >
                                R
                            </a>
                        </div>
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/freesurfer/" class="uk-label uk-label-secondary tags" >
                                Freesurfer
                            </a>
                        </div>
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/neuroimaging/" class="uk-label uk-label-secondary tags" >
                                Neuroimaging
                            </a>
                        </div>
                    
                </div>
            
        </div>
    </div>
        <div id="offcanvas-reveal" uk-offcanvas="mode: reveal; overlay: true">
            <div class="uk-offcanvas-bar">
                <button class="uk-offcanvas-close" type="button" uk-close></button>
                <h3>Table of Content</h3>
                <nav id="TableOfContents">
  <ul>
    <li><a href="#a-simplified-beginning-example">A simplified beginning example</a></li>
    <li><a href="#rs-model-matrix-creation">R&rsquo;s model matrix creation</a>
      <ul>
        <li><a href="#removing-the-intercept">Removing the intercept</a></li>
        <li><a href="#standardising-the-continuous-variables">Standardising the continuous variables</a></li>
        <li><a href="#adding-the-dependent-variable">Adding the dependent variable</a></li>
        <li><a href="#putting-it-all-together-in-a-function">Putting it all together in a function!</a></li>
      </ul>
    </li>
    <li><a href="#plot-the-qdec">Plot the qdec</a></li>
    <li><a href="#mo-this-is-too-much-i-just-want-to-use-it">Mo, this is too much, I just want to use it!</a></li>
  </ul>
</nav>
            </div>
        </div>
        
            <p class="uk-text-lead">Running Freesurfer Linear Mixed Models on vertex-vise data is a
popular way of capturing more advanced statistical models in
neuroimaging. In this post I highlight how you can prepare your
data in R for Freesurfer LMMs.</p>
        
        <div class="uk-markdown uk-width">
            <p>It&rsquo;s been a while since I&rsquo;ve been running models, I must admit.
I&rsquo;ve transitioned into more of a software engineering role, and I&rsquo;ve
been working on projects from another angle.
However, I&rsquo;ve been wanting to write this blogpost for a really long time.
The reason for that is that I was preparing files for colleagues based on our data, to run <a href="https://surfer.nmr.mgh.harvard.edu/fswiki/LinearMixedEffectsModels">Freesurfer Linear Mixes models</a>, or LMM&rsquo;s for short (also some times shortened to LME; Linear Mixed Effects).
While I was preparing these files, I realized that there is a lot of power in R that people are not utilizing to the best extent.
Me including, in the beginning!</p>
<p>In Neuroimaging, we are quite used to setting up model matrices (semi-) manually.
Meaning we sit down and make the matrices of <code>0</code> and <code>1</code> that
statistical models use at their core to do computations.
This is tedious and error-prone work, but we&rsquo;ve become so used to it we forget to explore if there is a better way.</p>
<p>R, at it&rsquo;s core being a statistical tool, has amazing tooling for running statistics.
This tooling, includes creating model matrices for us, so we don&rsquo;t have to think about it.</p>
<h2 id="a-simplified-beginning-example">A simplified beginning example</h2>
<p>The first story comes with an anecdote.
My boss asked me one day to run a model for him, in R.
This guy is super smart and knows exactly what he&rsquo;s after.
I run the model I believe he is asking for and provide the results,
after which he asks me run another model to verify.
In the data, we have a categorical variable, and he asks me to binarise them into variables representing each category, and use each of those in the model.</p>
<p>I know why he is asking for it, its what we are used to.
But I also know, that is the exact model I just ran, but R does that whole binarisation (i.e. making of the model matrix) for us.
Let&rsquo;s first explore with mtcars, just for simplicity.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyverse)
</span></span></code></pre></div><pre tabindex="0"><code>## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
## ✔ dplyr     1.1.4     ✔ readr     2.1.4
## ✔ forcats   1.0.0     ✔ stringr   1.5.1
## ✔ ggplot2   3.4.4     ✔ tibble    3.2.1
## ✔ lubridate 1.9.3     ✔ tidyr     1.3.0
## ✔ purrr     1.0.2     
## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()
## ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>cars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">as_tibble</span>(mtcars) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    cyl <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.factor</span>(cyl),  <span style="color:#75715e"># make cyl factor,</span>
</span></span><span style="display:flex;"><span>    gear <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.factor</span>(gear),  <span style="color:#75715e"># make gear factor</span>
</span></span><span style="display:flex;"><span>    carb <span style="color:#f92672">=</span> <span style="color:#a6e22e">as.factor</span>(carb),  <span style="color:#75715e"># make carb factor</span>
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>cars
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 11
##      mpg cyl    disp    hp  drat    wt  qsec    vs    am gear  carb 
##    &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;
##  1  21   6      160    110  3.9   2.62  16.5     0     1 4     4    
##  2  21   6      160    110  3.9   2.88  17.0     0     1 4     4    
##  3  22.8 4      108     93  3.85  2.32  18.6     1     1 4     1    
##  4  21.4 6      258    110  3.08  3.22  19.4     1     0 3     1    
##  5  18.7 8      360    175  3.15  3.44  17.0     0     0 3     2    
##  6  18.1 6      225    105  2.76  3.46  20.2     1     0 3     1    
##  7  14.3 8      360    245  3.21  3.57  15.8     0     0 3     4    
##  8  24.4 4      147.    62  3.69  3.19  20       1     0 4     2    
##  9  22.8 4      141.    95  3.92  3.15  22.9     1     0 4     2    
## 10  19.2 6      168.   123  3.92  3.44  18.3     1     0 4     4    
## # ℹ 22 more rows
</code></pre><p>To make a point, I&rsquo;ve altered some of the variables to be factors and logicals,
even if in this case the numbers are scalar and meaningful.</p>
<p>Now, let&rsquo;s say you want to know if miles per gallon (<code>mpg</code>) is affected by the number of cylinders (<code>cyl</code>), and horse powers (<code>hp</code>).
Your model might look like so: <code>mpg ~ cyl + hp</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(mpg <span style="color:#f92672">~</span> cyl <span style="color:#f92672">+</span> hp, data <span style="color:#f92672">=</span> cars)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span>(model)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = mpg ~ cyl + hp, data = cars)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.818 -1.959  0.080  1.627  6.812 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 28.65012    1.58779  18.044  &lt; 2e-16 ***
## cyl6        -5.96766    1.63928  -3.640  0.00109 ** 
## cyl8        -8.52085    2.32607  -3.663  0.00103 ** 
## hp          -0.02404    0.01541  -1.560  0.12995    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.146 on 28 degrees of freedom
## Multiple R-squared:  0.7539,	Adjusted R-squared:  0.7275 
## F-statistic: 28.59 on 3 and 28 DF,  p-value: 1.14e-08
</code></pre><p>Our results lets us know that increasing from 4 cylinders to 6 and from 4 cylinders to 8 has a significant effect on miles per gallon, but increasing horse power does not.</p>
<p>Ok, let&rsquo;s say I did this model the manual way.
I&rsquo;d need to binarise my categorical variables, to three columns
(where 1 would indicate if the car has a specific cylinder and 0 it does not),
and standardise the scalar variable (or at minimum demean it).</p>
<p>I could do like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>cars_std <span style="color:#f92672">&lt;-</span> cars <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">#transmute manipulates variables, and only returns what has been manipulated</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">transmute</span>(
</span></span><span style="display:flex;"><span>    mpg  <span style="color:#f92672">=</span> mpg,
</span></span><span style="display:flex;"><span>    cyl  <span style="color:#f92672">=</span> cyl,
</span></span><span style="display:flex;"><span>    cyl4 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">4</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>    cyl6 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>    cyl8 <span style="color:#f92672">=</span> <span style="color:#a6e22e">ifelse</span>(cyl <span style="color:#f92672">==</span> <span style="color:#ae81ff">8</span>, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">0</span>),
</span></span><span style="display:flex;"><span>    hp   <span style="color:#f92672">=</span> hp,
</span></span><span style="display:flex;"><span>    hpz  <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale</span>(hp, center <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>, scale <span style="color:#f92672">=</span> <span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>cars_std
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 7
##      mpg cyl    cyl4  cyl6  cyl8    hp hpz[,1]
##    &lt;dbl&gt; &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1  21   6         0     1     0   110  -0.535
##  2  21   6         0     1     0   110  -0.535
##  3  22.8 4         1     0     0    93  -0.783
##  4  21.4 6         0     1     0   110  -0.535
##  5  18.7 8         0     0     1   175   0.413
##  6  18.1 6         0     1     0   105  -0.608
##  7  14.3 8         0     0     1   245   1.43 
##  8  24.4 4         1     0     0    62  -1.24 
##  9  22.8 4         1     0     0    95  -0.754
## 10  19.2 6         0     1     0   123  -0.345
## # ℹ 22 more rows
</code></pre><p>I&rsquo;ve kept the original columns in addition to the new ones,
so we can see the difference.
The cylinders are now in binarised form, and the horse power is standardised.</p>
<p>We could now run the model like so:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_std <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">lm</span>(mpg <span style="color:#f92672">~</span> cyl6 <span style="color:#f92672">+</span> cyl8 <span style="color:#f92672">+</span> hpz, data <span style="color:#f92672">=</span> cars_std)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">summary</span>(model_std)
</span></span></code></pre></div><pre tabindex="0"><code>## 
## Call:
## lm(formula = mpg ~ cyl6 + cyl8 + hpz, data = cars_std)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.818 -1.959  0.080  1.627  6.812 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   25.124      1.369  18.354  &lt; 2e-16 ***
## cyl6          -5.968      1.639  -3.640  0.00109 ** 
## cyl8          -8.521      2.326  -3.663  0.00103 ** 
## hpz           -1.648      1.056  -1.560  0.12995    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.146 on 28 degrees of freedom
## Multiple R-squared:  0.7539,	Adjusted R-squared:  0.7275 
## F-statistic: 28.59 on 3 and 28 DF,  p-value: 1.14e-08
</code></pre><p>Notice how the results are exactly the same as the first model!
And there&rsquo;s a little sneakyness here too, can you see it?
Notice how I&rsquo;ve omitted the <code>cyl4</code> variable in the last model, why?
Because we have a model with an intercept, and in our original model,
<code>cyl4</code> is captured by the intercept, so we don&rsquo;t need to include it in the model.
Indeed, we should not, as it will create issues with multicollinearity.
The intercept here means &ldquo;where <code>cyl</code> is 4, and <code>hp</code> is 0&rdquo;.</p>
<h2 id="rs-model-matrix-creation">R&rsquo;s model matrix creation</h2>
<p>So how come this is possible?
When you run a model in R, using its model formula,
all the magic happens behind the scenes.
When I made the variables binary and standardised,
I mimmicked what R does for us.
While what I did was not very complex, you can imagine
that a larger model with more variables and interactions
might easily start making a pretty complex model matrix.
We don&rsquo;t want to make that by &ldquo;hand&rdquo;.</p>
<p>How does R make the model matrix, then?
Well, the <code>model.matrix</code> function is what we are looking for.
It takes our formula and data, just like the <code>lm</code> function,
but returns something quite different.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_matrix <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(mpg <span style="color:#f92672">~</span> cyl <span style="color:#f92672">+</span> hp, data <span style="color:#f92672">=</span> cars)
</span></span><span style="display:flex;"><span>model_matrix
</span></span></code></pre></div><pre tabindex="0"><code>##    (Intercept) cyl6 cyl8  hp
## 1            1    1    0 110
## 2            1    1    0 110
## 3            1    0    0  93
## 4            1    1    0 110
## 5            1    0    1 175
## 6            1    1    0 105
## 7            1    0    1 245
## 8            1    0    0  62
## 9            1    0    0  95
## 10           1    1    0 123
##  [ reached getOption(&#34;max.print&#34;) -- omitted 22 rows ]
## attr(,&#34;assign&#34;)
## [1] 0 1 1 2
## attr(,&#34;contrasts&#34;)
## attr(,&#34;contrasts&#34;)$cyl
## [1] &#34;contr.treatment&#34;
</code></pre><p>This model matrix is basically what is used when running the <code>lm</code> model.
We do have to do some things to get what we are after, though.
We are missing <code>mpg</code> which is our dependent variable, we need to put that back in.
And really, if we want to use this in a Freesurfer LMM, we also need to have a column binarised for all levels of categorical variables, and demeaned for scalar variables.
So, still some work to do!</p>
<h3 id="removing-the-intercept">Removing the intercept</h3>
<p>Getting rid of the intercept is, thankfully, not very difficult.
By default, all models in R have an intercept, because the models truly expand to <code>mpg ~ 1 + cyl + hp</code>, where <code>+ 1</code> is the indication to create the intercept.
If we want to remove it, we need to alter the sign of that <code>1</code> to negative: <code>mpg ~ -1 + cyl + hp</code>.
This means that there will be no intercept, and the model matrix will change.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_matrix <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(mpg <span style="color:#f92672">~</span> <span style="color:#ae81ff">-1</span> <span style="color:#f92672">+</span> cyl <span style="color:#f92672">+</span> hp, data <span style="color:#f92672">=</span> cars) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">as_tibble</span>()
</span></span><span style="display:flex;"><span>model_matrix
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 4
##     cyl4  cyl6  cyl8    hp
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1     0     1     0   110
##  2     0     1     0   110
##  3     1     0     0    93
##  4     0     1     0   110
##  5     0     0     1   175
##  6     0     1     0   105
##  7     0     0     1   245
##  8     1     0     0    62
##  9     1     0     0    95
## 10     0     1     0   123
## # ℹ 22 more rows
</code></pre><p>Now all the categorical levels has their own binary column.</p>
<h3 id="standardising-the-continuous-variables">Standardising the continuous variables</h3>
<p>While strictly speaking not necessary, standardising the continuous variables
is going to make your model run a little more efficiently.
When talking about running a model along 100k vertices,
every bit of help in making it more efficient is welcome.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_matrix <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    hpz <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale</span>(hp)
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 5
##     cyl4  cyl6  cyl8    hp hpz[,1]
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;
##  1     0     1     0   110  -0.535
##  2     0     1     0   110  -0.535
##  3     1     0     0    93  -0.783
##  4     0     1     0   110  -0.535
##  5     0     0     1   175   0.413
##  6     0     1     0   105  -0.608
##  7     0     0     1   245   1.43 
##  8     1     0     0    62  -1.24 
##  9     1     0     0    95  -0.754
## 10     0     1     0   123  -0.345
## # ℹ 22 more rows
</code></pre><p>The column name for the standardised variable is not great.
It has this weird <code>[,1]</code> at the end, what is that?
Well, if you have a look at the docs for the <code>scale()</code> function, it actually takes a matrix and returns a matrix, and we are using it on a single vector.
There are some ways around this, what I do, is make a simple wrapper function that does the same thing, but returns a vector instead of a matrix.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>scale_vec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(x, <span style="color:#66d9ef">...</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Error if x has more than one dimension</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">stopifnot</span>(<span style="color:#a6e22e">is.null</span>(<span style="color:#a6e22e">dim</span>(x)))
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># scale it</span>
</span></span><span style="display:flex;"><span>  x <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">scale</span>(x, <span style="color:#66d9ef">...</span>)
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># force into single vector</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">as.numeric</span>(x)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Let&rsquo;s unpack two things here:</p>
<ol>
<li>the use of <code>...</code></li>
<li>the <code>stopifnot</code> function</li>
</ol>
<p>The ellipsis (<code>...</code>) is a way to pass on arguments to another function.
In this case, I can allow anyone using the <code>scale_vec</code> function to
pass other arguments into the <code>scale</code> function.
It&rsquo;s a way for us to piggy-back on the functionality already present in <code>scale</code>.</p>
<p>The <code>stopifnot</code> is a function that will throw an error if the condition is not met.
In this case, I am checking if the input object <code>x</code> has dimensions.
If it does, I want to stop the function and throw an error.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># input is vector, works!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scale_vec</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>)
</span></span></code></pre></div><pre tabindex="0"><code>##  [1] -1.60579308 -1.43676223 -1.26773138 -1.09870053 -0.92966968 -0.76063883
##  [7] -0.59160798 -0.42257713 -0.25354628 -0.08451543  0.08451543  0.25354628
## [13]  0.42257713  0.59160798  0.76063883  0.92966968  1.09870053  1.26773138
## [19]  1.43676223  1.60579308
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># input is matrix, fails!</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">scale_vec</span>(<span style="color:#a6e22e">matrix</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">20</span>))
</span></span></code></pre></div><pre tabindex="0"><code>## Error in scale_vec(matrix(1:20)): is.null(dim(x)) is not TRUE
</code></pre><p>See how its erroring when I try to give in a matrix?
That&rsquo;s good, so we know we are inputing and returning the right thing.
If I put this in a package, I&rsquo;d also make a better error message, but for now, this is good enough.</p>
<p>Now we can make a better model matrix.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_matrix <span style="color:#f92672">&lt;-</span> model_matrix <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(
</span></span><span style="display:flex;"><span>    hpz <span style="color:#f92672">=</span> <span style="color:#a6e22e">scale_vec</span>(hp)
</span></span><span style="display:flex;"><span>  )
</span></span><span style="display:flex;"><span>model_matrix
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 5
##     cyl4  cyl6  cyl8    hp    hpz
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
##  1     0     1     0   110 -0.535
##  2     0     1     0   110 -0.535
##  3     1     0     0    93 -0.783
##  4     0     1     0   110 -0.535
##  5     0     0     1   175  0.413
##  6     0     1     0   105 -0.608
##  7     0     0     1   245  1.43 
##  8     1     0     0    62 -1.24 
##  9     1     0     0    95 -0.754
## 10     0     1     0   123 -0.345
## # ℹ 22 more rows
</code></pre><h3 id="adding-the-dependent-variable">Adding the dependent variable</h3>
<p>Lastly, we also need to add the dependent variable to the model matrix.
The model matrix does not include this, as it&rsquo;s not part of the
explanatory part, it&rsquo;s what we are trying to explain.
So we need to add it in.
Thankfully, since the model matrix will always return the rows
in the exact same order as the data, we can mutate it in.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>model_matrix <span style="color:#f92672">&lt;-</span> model_matrix <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(mpg <span style="color:#f92672">=</span> cars<span style="color:#f92672">$</span>mpg)
</span></span><span style="display:flex;"><span>model_matrix
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 6
##     cyl4  cyl6  cyl8    hp    hpz   mpg
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1     0     1     0   110 -0.535  21  
##  2     0     1     0   110 -0.535  21  
##  3     1     0     0    93 -0.783  22.8
##  4     0     1     0   110 -0.535  21.4
##  5     0     0     1   175  0.413  18.7
##  6     0     1     0   105 -0.608  18.1
##  7     0     0     1   245  1.43   14.3
##  8     1     0     0    62 -1.24   24.4
##  9     1     0     0    95 -0.754  22.8
## 10     0     1     0   123 -0.345  19.2
## # ℹ 22 more rows
</code></pre><h3 id="putting-it-all-together-in-a-function">Putting it all together in a function!</h3>
<p>Now, if you are doing this enough times, you are going to want a function.
Functions are a great way to make sure that the same process is being
applied across many different scenarios.
I love functions, i overuse them&hellip;but in this case it makes all the sense!</p>
<p>What we want to do when we make a function, is to abstract it enough so that we can be flexible in how we use it.
In this case, I&rsquo;d want a function with two arguments, like we did for model.matrix</p>
<ul>
<li><code>data</code> the data we are using</li>
<li><code>formula</code> the formula we are using</li>
</ul>
<p>I&rsquo;m gonna call the function <code>make_qdec</code> as qdec is what the Freesurfer LME docs call these files.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula){
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>We&rsquo;ve started our function, but we need to fill it in.
First, we need to find all the columns used in the formula, so we can build on those.
The <code>all.vars()</code> function can help us with that.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">all.vars</span>(mpg <span style="color:#f92672">~</span> cyl <span style="color:#f92672">+</span> hp)
</span></span></code></pre></div><pre tabindex="0"><code>## [1] &#34;mpg&#34; &#34;cyl&#34; &#34;hp&#34;
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Then, we could go ahead and subset the data to those columns right away,
so we have a neater bit of dataframe to work with.
Since <code>all.vars</code> returns a character vector, we can use the tidyselector <code>all_of</code> function from <code>dplyr</code> to select those columns.
Since we are already using tidyverse, that seems reasonable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># reduce data </span>
</span></span><span style="display:flex;"><span>  data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data, <span style="color:#a6e22e">all_of</span>(vars))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>After that, we can go ahead and make the model matrix,
and turn it into a tibble (dplyr special data.frame).
Additionally, we&rsquo;ll remove the unscaled continuous variables from the data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula){
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># reduce data </span>
</span></span><span style="display:flex;"><span>  data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data, <span style="color:#a6e22e">all_of</span>(vars))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create model matrix</span>
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(formula, data) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">as_tibble</span>()
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(mm, <span style="color:#a6e22e">which</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">names</span>(mm) <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">names</span>(data)))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, we also need to get the continuous variables standardised.
Since there is a great chanse more than a single scalar variable
has been requested, we should do a bit of dplyr magic to get all
scalar variables selected standardised.
To do this, we are going to use the <code>across</code> function from <code>dplyr</code>,
which for sure is one of my favourite functions in the package.
Its a little mouthfull (keyboardfull?), but its elegant and powerful.</p>
<p>Lets use it first outside our function, to see.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>cars <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">transmute</span>(
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">across</span>( <span style="color:#75715e"># across several columns</span>
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># that are numeric</span>
</span></span><span style="display:flex;"><span>      .cols  <span style="color:#f92672">=</span> <span style="color:#a6e22e">where</span>(is.numeric), 
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># and apply the scale_vec function</span>
</span></span><span style="display:flex;"><span>      .fns   <span style="color:#f92672">=</span> scale_vec,
</span></span><span style="display:flex;"><span>      <span style="color:#75715e"># suffix orig col name with z</span>
</span></span><span style="display:flex;"><span>      .names <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{col}z&#34;</span>
</span></span><span style="display:flex;"><span>    ))
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 8
##      mpgz   dispz    hpz  dratz      wtz  qsecz    vsz    amz
##     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1  0.151 -0.571  -0.535  0.568 -0.610   -0.777 -0.868  1.19 
##  2  0.151 -0.571  -0.535  0.568 -0.350   -0.464 -0.868  1.19 
##  3  0.450 -0.990  -0.783  0.474 -0.917    0.426  1.12   1.19 
##  4  0.217  0.220  -0.535 -0.966 -0.00230  0.890  1.12  -0.814
##  5 -0.231  1.04    0.413 -0.835  0.228   -0.464 -0.868 -0.814
##  6 -0.330 -0.0462 -0.608 -1.56   0.248    1.33   1.12  -0.814
##  7 -0.961  1.04    1.43  -0.723  0.361   -1.12  -0.868 -0.814
##  8  0.715 -0.678  -1.24   0.175 -0.0278   1.20   1.12  -0.814
##  9  0.450 -0.726  -0.754  0.605 -0.0687   2.83   1.12  -0.814
## 10 -0.148 -0.509  -0.345  0.605  0.228    0.253  1.12  -0.814
## # ℹ 22 more rows
</code></pre><p>Unpacking again.
In our transmute (which only returns altered columns),
we are using the <code>across</code> function to apply a function to several columns.
We use tidyselectors to choose which columns we want to apply the function to,
in this case, <code>where</code> the columns are <code>numeric</code> (integer, or float/double).
We then apply the function <code>scale_vec</code> to each of those columns,
and then name the new columns with the original name, but with a <code>z</code> at the end.
This is a lot in a single function,
but you can see how it so nicely can do exactly what we are after!</p>
<p>Putting that in our function, we get:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula, path <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># reduce data </span>
</span></span><span style="display:flex;"><span>  data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data, <span style="color:#a6e22e">all_of</span>(vars))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create model matrix</span>
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(formula, data) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">as_tibble</span>()
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(mm, <span style="color:#a6e22e">which</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">names</span>(mm) <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">names</span>(data)))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># scale continuous variables</span>
</span></span><span style="display:flex;"><span>  dataz <span style="color:#f92672">&lt;-</span> data <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">transmute</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">across</span>( 
</span></span><span style="display:flex;"><span>        .cols  <span style="color:#f92672">=</span> <span style="color:#a6e22e">where</span>(is.numeric), 
</span></span><span style="display:flex;"><span>        .fns   <span style="color:#f92672">=</span> scale_vec,
</span></span><span style="display:flex;"><span>        .names <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{col}z&#34;</span>
</span></span><span style="display:flex;"><span>      ))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Now, we have the model matrix, and scaled variables, we need to combine them.
Since we are already using <code>dplyr</code> let&rsquo;s stick with that, and use <code>bind_cols()</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula, path <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># reduce data </span>
</span></span><span style="display:flex;"><span>  data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data, <span style="color:#a6e22e">all_of</span>(vars))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create model matrix</span>
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(formula, data) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">as_tibble</span>()
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># scale continuous variables</span>
</span></span><span style="display:flex;"><span>  dataz <span style="color:#f92672">&lt;-</span> data <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">transmute</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">across</span>( 
</span></span><span style="display:flex;"><span>        .cols  <span style="color:#f92672">=</span> <span style="color:#a6e22e">where</span>(is.numeric), 
</span></span><span style="display:flex;"><span>        .fns   <span style="color:#f92672">=</span> scale_vec,
</span></span><span style="display:flex;"><span>        .names <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{col}z&#34;</span>
</span></span><span style="display:flex;"><span>      ))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># combine model matrix and scaled data</span>
</span></span><span style="display:flex;"><span>  qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_cols</span>(mm, dataz)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">return</span>(qdec)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And at the end we return the qdec.
Let&rsquo;s take it for a spin!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">make_qdec</span>(cars, mpg <span style="color:#f92672">~</span> cyl <span style="color:#f92672">+</span> hp)
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 6
##    `(Intercept)`  cyl6  cyl8    hp   mpgz    hpz
##            &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1             1     1     0   110  0.151 -0.535
##  2             1     1     0   110  0.151 -0.535
##  3             1     0     0    93  0.450 -0.783
##  4             1     1     0   110  0.217 -0.535
##  5             1     0     1   175 -0.231  0.413
##  6             1     1     0   105 -0.330 -0.608
##  7             1     0     1   245 -0.961  1.43 
##  8             1     0     0    62  0.715 -1.24 
##  9             1     0     0    95  0.450 -0.754
## 10             1     1     0   123 -0.148 -0.345
## # ℹ 22 more rows
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">make_qdec</span>(cars, mpg <span style="color:#f92672">~</span> <span style="color:#ae81ff">-1</span> <span style="color:#f92672">+</span>  cyl <span style="color:#f92672">+</span> hp)
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 6
##     cyl4  cyl6  cyl8    hp   mpgz    hpz
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1     0     1     0   110  0.151 -0.535
##  2     0     1     0   110  0.151 -0.535
##  3     1     0     0    93  0.450 -0.783
##  4     0     1     0   110  0.217 -0.535
##  5     0     0     1   175 -0.231  0.413
##  6     0     1     0   105 -0.330 -0.608
##  7     0     0     1   245 -0.961  1.43 
##  8     1     0     0    62  0.715 -1.24 
##  9     1     0     0    95  0.450 -0.754
## 10     0     1     0   123 -0.148 -0.345
## # ℹ 22 more rows
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">make_qdec</span>(cars, mpg <span style="color:#f92672">~</span> <span style="color:#ae81ff">-1</span> <span style="color:#f92672">+</span>  cyl <span style="color:#f92672">+</span> hp <span style="color:#f92672">+</span> disp <span style="color:#f92672">+</span> gear)
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 10
##     cyl4  cyl6  cyl8    hp  disp gear4 gear5   mpgz    hpz   dispz
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     0     1     0   110  160      1     0  0.151 -0.535 -0.571 
##  2     0     1     0   110  160      1     0  0.151 -0.535 -0.571 
##  3     1     0     0    93  108      1     0  0.450 -0.783 -0.990 
##  4     0     1     0   110  258      0     0  0.217 -0.535  0.220 
##  5     0     0     1   175  360      0     0 -0.231  0.413  1.04  
##  6     0     1     0   105  225      0     0 -0.330 -0.608 -0.0462
##  7     0     0     1   245  360      0     0 -0.961  1.43   1.04  
##  8     1     0     0    62  147.     1     0  0.715 -1.24  -0.678 
##  9     1     0     0    95  141.     1     0  0.450 -0.754 -0.726 
## 10     0     1     0   123  168.     1     0 -0.148 -0.345 -0.509 
## # ℹ 22 more rows
</code></pre><p>Our function works!
We have lovely files to use in our freesurfer LME analysis.
But having them inside R is not gonna help though,
we need to write them to file so we can use them.</p>
<p>In this case, since this is basically what you want to do with the function,
adding a <code>path</code> argument to the function, and then writing the file to that path,
seems like a good idea.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>make_qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">function</span>(data, formula, path <span style="color:#f92672">=</span> <span style="color:#66d9ef">NULL</span>) {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># extract variable names from formula</span>
</span></span><span style="display:flex;"><span>  vars <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">all.vars</span>(formula)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># reduce data </span>
</span></span><span style="display:flex;"><span>  data <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(data, <span style="color:#a6e22e">all_of</span>(vars))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># create model matrix</span>
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">model.matrix</span>(formula, data) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">as_tibble</span>()
</span></span><span style="display:flex;"><span>  mm <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">select</span>(mm, <span style="color:#a6e22e">which</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">names</span>(mm) <span style="color:#f92672">%in%</span> <span style="color:#a6e22e">names</span>(data)))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># scale continuous variables</span>
</span></span><span style="display:flex;"><span>  dataz <span style="color:#f92672">&lt;-</span> data <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">transmute</span>(
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">across</span>( 
</span></span><span style="display:flex;"><span>        .cols  <span style="color:#f92672">=</span> <span style="color:#a6e22e">where</span>(is.numeric), 
</span></span><span style="display:flex;"><span>        .fns   <span style="color:#f92672">=</span> scale_vec,
</span></span><span style="display:flex;"><span>        .names <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;{col}z&#34;</span>
</span></span><span style="display:flex;"><span>      ))
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># combine model matrix and scaled data</span>
</span></span><span style="display:flex;"><span>  qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">bind_cols</span>(mm, dataz)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># write to path if requested</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">if</span>(<span style="color:#f92672">!</span><span style="color:#a6e22e">is.null</span>(path)){
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">write.csv</span>(qdec, path, row.names <span style="color:#f92672">=</span> <span style="color:#66d9ef">FALSE</span>)
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">return</span>(qdec)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>And there we have an entire function to use for making our Freesurfer qdec files from R, using R&rsquo;s built-in stats power to help us.</p>
<h2 id="plot-the-qdec">Plot the qdec</h2>
<p>Some times, it&rsquo;s nice to see what you have made.
I, at least, always feel I get a better idea of what I&rsquo;m working
with when I have it visualised in front of me.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>qdec <span style="color:#f92672">&lt;-</span> <span style="color:#a6e22e">make_qdec</span>(cars, mpg <span style="color:#f92672">~</span> <span style="color:#ae81ff">-1</span> <span style="color:#f92672">+</span>  cyl <span style="color:#f92672">+</span> hp <span style="color:#f92672">+</span> disp <span style="color:#f92672">+</span> gear)
</span></span><span style="display:flex;"><span>qdec
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 32 × 8
##     cyl4  cyl6  cyl8 gear4 gear5   mpgz    hpz   dispz
##    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
##  1     0     1     0     1     0  0.151 -0.535 -0.571 
##  2     0     1     0     1     0  0.151 -0.535 -0.571 
##  3     1     0     0     1     0  0.450 -0.783 -0.990 
##  4     0     1     0     0     0  0.217 -0.535  0.220 
##  5     0     0     1     0     0 -0.231  0.413  1.04  
##  6     0     1     0     0     0 -0.330 -0.608 -0.0462
##  7     0     0     1     0     0 -0.961  1.43   1.04  
##  8     1     0     0     1     0  0.715 -1.24  -0.678 
##  9     1     0     0     1     0  0.450 -0.754 -0.726 
## 10     0     1     0     1     0 -0.148 -0.345 -0.509 
## # ℹ 22 more rows
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>qdec <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(row <span style="color:#f92672">=</span> <span style="color:#a6e22e">row_number</span>()) <span style="color:#f92672">|&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">pivot_longer</span>(<span style="color:#f92672">-</span>row, names_to <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;column&#34;</span>) <span style="color:#f92672">|&gt;</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggplot</span>(<span style="color:#a6e22e">aes</span>(y <span style="color:#f92672">=</span> row, x <span style="color:#f92672">=</span> column, fill <span style="color:#f92672">=</span> value)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_tile</span>() <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_viridis_c</span>(alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.8</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(
</span></span><span style="display:flex;"><span>    title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;qdec file content&#34;</span>
</span></span><span style="display:flex;"><span>  )
</span></span></code></pre></div><img src="https://drmowinckels.io/blog/2024/freesurfer-lmm-r/index_files/figure-html/featured-1.png" width="672" />
<p>Through this plot I can see which data is binary (column only has two colours),
and which are continuous (column has a gradient of colours).
It&rsquo;s a nice way to verify that my file contains what I am after.</p>
<h2 id="mo-this-is-too-much-i-just-want-to-use-it">Mo, this is too much, I just want to use it!</h2>
<p>Ok, I get it.
You&rsquo;re not here to do all the hard-coding, you just need an easy use.
We all battle the balance between time spent learning to do something,
and getting things done.
There&rsquo;s already so much to learn when doing neuroimaging,
learning to write R functions for things like this is much.</p>
<p>I have two solutions:</p>
<ol>
<li>Copy paste my last function and use that</li>
<li>Give my mini-package, neuromat a try</li>
</ol>
<p>It&rsquo;s the tiniest package I ever made, but it&rsquo;s a package,
and I hope it can ease your vertex-wise Freesurfer LMM journey!
You can install it from my team&rsquo;s R-Universe with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Install from Capro R-universe</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">install.packages</span>(<span style="color:#e6db74">&#39;neuromat&#39;</span>, 
</span></span><span style="display:flex;"><span>                 repos <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;https://capro-uio.r-universe.dev&#39;</span>)
</span></span></code></pre></div><p>and you can have a look at the currently very minimal docs
<a href="https://www.capro.dev/neuromat/">online</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">rm</span>(make_qdec, scale_vec)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(neuromat)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">make_fs_qdec</span>(
</span></span><span style="display:flex;"><span>  cars, 
</span></span><span style="display:flex;"><span>  mpg <span style="color:#f92672">~</span> <span style="color:#ae81ff">-1</span> <span style="color:#f92672">+</span>  cyl <span style="color:#f92672">+</span> hp <span style="color:#f92672">+</span> disp <span style="color:#f92672">+</span> gear,
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># Keep original data columns, for comparison</span>
</span></span><span style="display:flex;"><span>  keep <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;mpg&#34;</span>, <span style="color:#e6db74">&#34;cyl&#34;</span>, <span style="color:#e6db74">&#34;hp&#34;</span>, <span style="color:#e6db74">&#34;disp&#34;</span>, <span style="color:#e6db74">&#34;gear&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><pre tabindex="0"><code>##   cyl4 cyl6 cyl8 gear4 gear5      mpgz        hpz      dispz  mpg cyl  hp disp
## 1    0    1    0     1     0 0.1508848 -0.5350928 -0.5706198 21.0   6 110  160
## 2    0    1    0     1     0 0.1508848 -0.5350928 -0.5706198 21.0   6 110  160
## 3    1    0    0     1     0 0.4495434 -0.7830405 -0.9901821 22.8   4  93  108
##   gear
## 1    4
## 2    4
## 3    4
##  [ reached &#39;max&#39; / getOption(&#34;max.print&#34;) -- omitted 29 rows ]
</code></pre><p>I hope you find it useful, and if you have any feedback,
please let me know!</p>

        </div>
    </article><div class="uk-margin">
    <button  class="uk-button uk-button-default" uk-toggle="target: #citation; animation: uk-animation-fade" type="button">
        Cite me!
    </button>
    <div id="citation" hidden class="uk-margin">
        <div uk-grid class="uk-child-width-1-2@s">
            <div>
                For attribution, please cite this work as
                <div class="uk-card uk-card-default uk-card-bod uk-text-breaky">
                    Dr. Mowinckel 
                    (Mar 1, 2024) 
                    Setting up a Freesurfer LMM through R. 
                    Retrieved from https://drmowinckels.io/blog/2024/freesurfer-lmm-r/.
                     DOI: https://www.doi.org/10.5281/zenodo.13273543
                </div>
            </div>
            <div>
                <b>BibTeX citation</b>
                <div class="uk-card uk-card-default uk-card-body uk-text-break">
                    @misc{ <br>
                        2024-setting-up-a-freesurfer-lmm-through-r,<br>
                        &emsp;author =  "Dr. Mowinckel",<br>
                        &emsp;title = "Setting up a Freesurfer LMM through R",<br>
                        &emsp;url = "https://drmowinckels.io/blog/2024/freesurfer-lmm-r/",<br>
                        &emsp;year = 2024,<br>
                         &emsp;doi = "https://www.doi.org/10.5281/zenodo.13273543",<br> 
                        &emsp;updated = "Oct 7, 2024"<br>
                    }
                </div>
            </div>
        </div>
    </div>
</div><div class="uk-grid uk-child-width-expand@s uk-margin-top" uk-grid>
    <div class="uk-width-expand">
        
            <a class="uk-button uk-button-default" href="https://drmowinckels.io/blog/2024/teaching-unlocks/">
                <span class="uk-margin-small-left" uk-icon="chevron-double-left"></span>
                Teaching you - teaching me
            </a>
        
    </div>
    
    <div class="uk-width-auto">
        
            <a class="uk-button uk-button-default" href="https://drmowinckels.io/blog/2024/git-clean-woes/">
                Too much git cleaning
                <span class="uk-margin-small-right" uk-icon="chevron-double-right"></span>
            </a>
        
    </div>
</div>

    
    
        <div class="uk-container uk-margin-top">
            <script src="https://giscus.app/client.js"
                data-repo=DrMowinckels/drmowinckels.github.io
                data-repo-id=MDEwOlJlcG9zaXRvcnkxMjM0NzEwMTI&#61;
                data-category=Comments
                data-category-id=DIC_kwDOB1wEpM4CAG0c
                data-mapping=pathname
                data-reactions-enabled=1
                data-emit-metadata=0
                data-theme=light
                data-lang=en
                crossorigin="anonymous"
                async>
            </script>
</div>

    

        </div><div class="section uk-section uk-padding-remove-vertical uk-margin">
    <div class="banner footer" height="500px">
        <div class="uk-container">
            <div class="uk-grid" uk-grid>
                <div class="uk-width-1-2@m">
                    
                      <h3><i class="fa-regular fa-copyright"></i> 2023 Athanasia Mo Mowinckel</h3>
                      <p></p>
                    
                  </div>
              <div class="uk-width-1-2@m">
                
              </div>
            </div>
          </div>
          <div class="footer-title uk-text-right">
            <h1>Dr. Mowinckel&rsquo;s</h1>
        </div>
    </div>
</div>
</body>
</html>
