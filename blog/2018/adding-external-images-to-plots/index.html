<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>


<title>Adding external images to plots - Dr. Mowinckel&#39;s</title>


<meta name="hugo-igloo" />




  <meta name="description" content="Adding external images to plots is a good way to showcase results, and make it easier for me and my reader to understand what the findings are . I use [ImageMagick] for this, but there are R-packages to help, like [imager] and [imaging] software ." />
  <meta name="author" content="DrMowinckels" />






<meta name="generator" content="Hugo 0.119.0">



        

<meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://drmowinckels.io/">
<meta prefix="og: http://ogp.me/ns#" property="og:type" content="website">
<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Adding external images to plots - Dr. Mowinckel&rsquo;s">
<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Adding external images to plots is a good way to showcase results, and make it easier for me and my reader to understand what the findings are . I use [ImageMagick] for this, but there are R-packages to help, like [imager] and [imaging] software .">


<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:domain" content="https://drmowinckels.io/">
<meta name="twitter:title" content="Igloo">
<meta name="twitter:description" content="Adding external images to plots is a good way to showcase results, and make it easier for me and my reader to understand what the findings are . I use [ImageMagick] for this, but there are R-packages to help, like [imager] and [imaging] software .">



    <meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://drmowinckels.io/blog/2018/adding-external-images-to-plots/index_files/figure-html/unnamed-chunk-16-1.png" />
    <meta name="twitter:image" content="https://drmowinckels.io/blog/2018/adding-external-images-to-plots/index_files/figure-html/unnamed-chunk-16-1.png">



        
  





    



 

    <link rel="stylesheet" href="https://drmowinckels.io/bundle.min.b949f82ef13ab020c09cc9a01a06b5c35de205c6382cde6ed472ebf5efc8e9d2.css" 
    integrity="sha256-uUn4LvE6sCDAnMmgGga1w13iBcY4LN5u1HLr9e/I6dI=" 
    crossorigin="anonymous">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/night-owl.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>



    <script src="https://drmowinckels.io/uikit/dist/js/uikit.min.js"></script>


    <script src="https://drmowinckels.io/uikit/dist/js/uikit-icons.min.js"></script>



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha384-k6Rqe5g0pSv8V0e6fFfFjW1y77vKTjkE1IUaB+MHUO2GtODX6azbMqa6Y53/zJTU" crossorigin="anonymous">

        



    

    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_16x0_resize_box_3.png"
        sizes="16x16"
        type="image/png"
    />
    
    
    
        
        <link rel="shortcut icon" href="https://drmowinckels.io/favicon.ico" type="image/x-icon">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_32x0_resize_box_3.png"
        sizes="32x32"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_57x0_resize_box_3.png"
        sizes="57x57"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_76x0_resize_box_3.png"
        sizes="76x76"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_96x0_resize_box_3.png"
        sizes="96x96"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_128x0_resize_box_3.png"
        sizes="128x128"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_120x0_resize_box_3.png"
        sizes="120x120"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_150x0_resize_box_3.png"
        sizes="150x150"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_152x0_resize_box_3.png"
        sizes="152x152"
        type="image/png"
    />
    
    
    
        <meta name="msapplication-TileImage" 
            content="/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_144x0_resize_box_3.png">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_144x0_resize_box_3.png"
        sizes="144x144"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_180x0_resize_box_3.png"
        sizes="180x180"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_192x0_resize_box_3.png"
        sizes="192x192"
        type="image/png"
    />
    
    
    
    <link
        rel="shortcut icon"
        href="https://drmowinckels.io/img/fav.ico_hu5c0771520169a7c5939dfeb49415bb9c_5256_196x0_resize_box_3.png"
        sizes="196x196"
        type="image/png"
    />
<meta name="msapplication-TileColor" content="#198c8c">
<meta name="theme-color" content="#198c8c"> 
<meta name="msapplication-TileColor" content="#198c8c">

    </head>
    <body>
            
<div class="banner ">
    
        <div class="uk-container uk-container-small banner-top">
            <h1>blog</h1>
        </div>
    
</div>

        



<div id="smallnav" uk-offcanvas="flip: true" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">
        <ul class="uk-nav">
            
                <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                    <img src="https://drmowinckels.io/img/logo.png" width="40">
                </a> 
            
            
                <li>
                    <a href="https://drmowinckels.io/about">
                        About
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/blog">
                        Blog
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/talks">
                        Talks
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/projects">
                        Projects
                        
                    </a>
                    
                </li>
            
        </ul>
    </div>
</div>
<a class="uk-navbar-container uk-navbar-left uk-navbar-toggle uk-hidden@s" uk-toggle="target: #smallnav" uk-navbar-toggle-icon></a>

<div class="uk-visible@s" uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky">
    <nav class="uk-navbar-container">   
        <div uk-navbar>     
            <div class="uk-navbar-center">
                
                    
                        <div class="uk-navbar-center-left">
                            <ul class="uk-navbar-nav">
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/about">
                            About
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/blog">
                            Blog
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
                    
                    
                        
                            <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                                <img src="https://drmowinckels.io/img/logo.png" width="40">
                            </a> 
                        
                        <div class="uk-navbar-center-right">
                            <ul class="uk-navbar-nav"> 
                    
                    <li>
                        <a href="https://drmowinckels.io/talks">
                            Talks
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/projects">
                            Projects
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
            </div>
        </div>
    </nav>
</div>


        <div id="content" class="uk-container uk-container-small uk-margin-large-top">
    <article class="uk-article">
        <div class="uk-grid uk-flex-top" uk-grid>
            
            
            <div class="uk-width-1-4@s">
              <img src="https://drmowinckels.io/blog/2018/adding-external-images-to-plots/index_files/figure-html/unnamed-chunk-16-1.png" alt="Adding external images to plots" class="uk-border-rounded">
              
            </div>

        <div class="uk-width-3-4@s">
        <h1 class="uk-article-title">Adding external images to plots</h1>
        
        <div class="uk-border-top uk-article-meta uk-flex uk-flex-center uk-flex-between">
            <h3 class="uk-margin-top-small">
                May 7, 2018
            </h3>
            

            
                <div class="uk-flex uk-flex-wrap uk-flex-right">
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/r/" class="uk-label uk-label-secondary tags" >
                                R
                            </a>
                        </div>
                    
                </div>
            
        </div>
    </div>
        <div id="offcanvas-reveal" uk-offcanvas="mode: reveal; overlay: true">
            <div class="uk-offcanvas-bar">
                <button class="uk-offcanvas-close" type="button" uk-close></button>
                <h3>Table of Content</h3>
                <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
    <li><a href="#the-data">The Data</a></li>
    <li><a href="#lets-do-some-plotting">Let&rsquo;s do some plotting!</a></li>
  </ul>
</nav>
            </div>
        </div>
        
            <p class="uk-text-lead">Adding external images to plots is a good way to showcase results, and make it easier for me and my reader to understand what the findings are . I use [ImageMagick] for this, but there are R-packages to help, like [imager] and [imaging] software .</p>
        
        <div class="uk-markdown uk-width">
            <p>Two weeks ago we had out first RLadies-Oslo meetup! It was such a great turnout, and I had so much fun presenting to the group of lovely folks!</p>
<p>And indeed it is true, I love plotting. Probably more than I love analysing data (and definately more than cleaning and wrangling :P). I can spend hours and hours creating my own custom plotting functions for whatever paper/output I am currently working on. I&rsquo;m not sure if this is a productive way of spending my time, but it&rsquo;s fun and instantly grattifying.</p>
<p>Given that I&rsquo;m in neuroimaging, I actually quite often find myself in need of adding neuroimages (brains!) to my plots, to aid interpretation and the reader. Having the data plotted, with the brain images that correspond to the data, is a good way to showcase results, and make it easier both for me and my reader to understand what the findings are.</p>
<h4 id="when-wanting-to-add-external-images-to-plots-there-are-several-necessary-steps">When wanting to add external images to plots, there are several necessary steps:</h4>
<ol>
<li>You need to create all the images you might want to add, place them in a folder, and give the images names (drop the whitespaces) that make sense according to the data you have.</li>
<li>The images <strong>might</strong> need to be processed to make plotting easier (i.e. them being the same size, backgrounds transparent etc.) I use <a href="https://www.imagemagick.org/script/index.php">ImageMagick</a> for this, but there are R-packages to help, like <a href="https://cran.r-project.org/web/packages/imager/vignettes/gettingstarted.html">imager</a></li>
<li>A clear idea of what you want to plot and why</li>
</ol>
<ul>
<li><strong>how</strong> comes with trial-and-error and perserverence (and hopefully with the help of this post)</li>
</ul>
<h2 id="the-data">The Data</h2>
<p>All my images have been extracted with a neuroimaging analysis software I regularly use; <a href="">FSL</a>. FSL provides all brains on black backgrounds, which I have stripped so they are transparent, for nicer plotting. I&rsquo;ll leave out image manipulation from this post, I&rsquo;m planning something on that later.</p>
<p>I have all my images in a folder called <code>single</code> which is within a folder called <code>brainSlices</code>. First of all, we need to read in the paths for all the files we want to add, so having them stored all within a folder, with nice naming conventions, makes life easier. I&rsquo;ll place them all in a data.frame I&rsquo;ll call <code>DATA</code> in a columns names <code>images</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>DATA <span style="color:#f92672">=</span> <span style="color:#a6e22e">data.frame</span>(images<span style="color:#f92672">=</span><span style="color:#a6e22e">list.files</span>(<span style="color:#e6db74">&#34;brainSlices/single&#34;</span>, full.names <span style="color:#f92672">=</span> T), stringsAsFactors <span style="color:#f92672">=</span> F)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(DATA)
</span></span></code></pre></div><pre tabindex="0"><code>##                              images
## 1 brainSlices/single/0000_trans.png
## 2 brainSlices/single/0001_trans.png
## 3 brainSlices/single/0002_trans.png
## 4 brainSlices/single/0003_trans.png
## 5 brainSlices/single/0004_trans.png
## 6 brainSlices/single/0005_trans.png
</code></pre><p>My files a pretty simple, numbered images, corresponding to some brain network. Now that I have all the image file paths nicely stored, I&rsquo;ll also generate som decent names for the images, so that we an plot them with labels.</p>
<p>I&rsquo;ll strip the filepaths for everything that is <strong>not</strong> numeric, so I can have only the numbers (of course, these are so nicely ordered I could have generated a sequence of numbers).</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>DATA<span style="color:#f92672">$</span>names <span style="color:#f92672">=</span> <span style="color:#a6e22e">gsub</span>(<span style="color:#e6db74">&#34;[a-zA-Z]|[[:punct:]]&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>,DATA<span style="color:#f92672">$</span>images)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(DATA)
</span></span></code></pre></div><pre tabindex="0"><code>##                              images names
## 1 brainSlices/single/0000_trans.png  0000
## 2 brainSlices/single/0001_trans.png  0001
## 3 brainSlices/single/0002_trans.png  0002
## 4 brainSlices/single/0003_trans.png  0003
## 5 brainSlices/single/0004_trans.png  0004
## 6 brainSlices/single/0005_trans.png  0005
</code></pre><p>We also generate some random values that we assign to the brain networks, so we have some values to plot!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>DATA<span style="color:#f92672">$</span>values <span style="color:#f92672">=</span> <span style="color:#a6e22e">sample</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">100</span>, size<span style="color:#f92672">=</span><span style="color:#a6e22e">nrow</span>(DATA))
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">head</span>(DATA)
</span></span></code></pre></div><pre tabindex="0"><code>##                              images names values
## 1 brainSlices/single/0000_trans.png  0000     26
## 2 brainSlices/single/0001_trans.png  0001     43
## 3 brainSlices/single/0002_trans.png  0002     53
## 4 brainSlices/single/0003_trans.png  0003     69
## 5 brainSlices/single/0004_trans.png  0004     78
## 6 brainSlices/single/0005_trans.png  0005     86
</code></pre><h2 id="lets-do-some-plotting">Let&rsquo;s do some plotting!</h2>
<p>I always start out with what the data plot will look like first, then add inn the images last. This is the easiest process, in my opinion. So, we make a bar chart of the values for each network on the y-axis, and each network on the x-axis. We use the <code>stat=&quot;identity&quot;</code> option, because we want to plot the actual value provided on the y, not a count of the x-axis occurence, which is default bar chart behaviour.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(ggplot2)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(DATA) <span style="color:#f92672">+</span> <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><p><img src="index_files/figure-html/unnamed-chunk-5-1.png" alt=""><!-- --></p>
<p>That&rsquo;s a bar chart alright! Ok, let&rsquo;s increase complexity by adding <strong>one</strong> image to begin with. The function I use to add external images is <code>annotate_custom</code> which is the only ggplot function I have found that will do what I want. But first, we will need to actually read in the image from it&rsquo;s filepath, transform it into a graphics object <code>grob</code> within R, so that we may plot it. For this we need both the <code>png</code> and <code>grid</code> packages.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(png); <span style="color:#a6e22e">library</span>(grid);
</span></span></code></pre></div><p>we read in the png from the first file into a variable.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>img <span style="color:#f92672">=</span> <span style="color:#a6e22e">readPNG</span>(DATA<span style="color:#f92672">$</span>images[1])
</span></span></code></pre></div><p>And transform it into a graphics object (grob)</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>g <span style="color:#f92672">=</span>  <span style="color:#a6e22e">rasterGrob</span>(img, interpolate<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
</span></span></code></pre></div><p>Now that it&rsquo;s a graphics object, we can place it in the plot. <code>annotate_custom</code> requires a placement of the object just like a rectangle would, <code>xmin</code>, <code>xmax</code>, <code>ymin</code> and <code>ymax</code>, this works well for us, as our images are rectangles (even with transparent backgrounds).</p>
<p>Given that this is a bar chart, where each element on the x is centered on an integer, I&rsquo;m using xmin and xmax on x -/+ 0.5, to get the image in the right spot. The y really depends on the aspect ratio of your image, trial-and-error is usually needed to get it in the right size.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggplot</span>(DATA) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">annotation_custom</span>(grob<span style="color:#f92672">=</span>g, xmin<span style="color:#f92672">=</span><span style="color:#ae81ff">.5</span>, xmax<span style="color:#f92672">=</span><span style="color:#ae81ff">1.5</span>, ymin<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, ymax<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><p><img src="index_files/figure-html/unnamed-chunk-9-1.png" alt=""><!-- -->
Whoop! Brain in plot! Now, let&rsquo;s get them all in there! I do this in for loops, because I just don&rsquo;t know any other way to do it. If you do, post me a comment. I&rsquo;ll be so thankful for a more elegant solution!</p>
<p>Untill then, let&rsquo;s get for-looping.
First, save the base plot to an object in your environment, one of the lovely things with ggplot it the possibility to incrementally add elements to it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">=</span> <span style="color:#a6e22e">ggplot</span>(DATA) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>) 
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(DATA)){
</span></span><span style="display:flex;"><span>  img <span style="color:#f92672">=</span> <span style="color:#a6e22e">readPNG</span>(DATA<span style="color:#f92672">$</span>images[i])
</span></span><span style="display:flex;"><span>  g[[i]] <span style="color:#f92672">=</span>  <span style="color:#a6e22e">rasterGrob</span>(img, interpolate<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  PLOT <span style="color:#f92672">=</span> PLOT <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotation_custom</span>(grob<span style="color:#f92672">=</span>g[[i]], xmin<span style="color:#f92672">=</span>i<span style="color:#ae81ff">-.5</span>, xmax<span style="color:#f92672">=</span>i<span style="color:#ae81ff">+.5</span>, ymin<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, ymax<span style="color:#f92672">=</span><span style="color:#ae81ff">10</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLOT
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-10-1.png" alt=""><!-- --></p>
<p>Whoop! More brains in plot! The axis text is a little hard to read, so we can angle it for better viewing. Which we can conveniently do with ggplots lovely theme operations.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-11-1.png" alt=""><!-- --></p>
<p>Unfortunately, some of our brains are in the foreground of their bar-top, and so the value is hard to see. We can try placing the brains on above the bars instead.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">=</span> <span style="color:#a6e22e">ggplot</span>(DATA) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>) 
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(DATA)){
</span></span><span style="display:flex;"><span>  img <span style="color:#f92672">=</span> <span style="color:#a6e22e">readPNG</span>(DATA<span style="color:#f92672">$</span>images[i])
</span></span><span style="display:flex;"><span>  g[[i]] <span style="color:#f92672">=</span>  <span style="color:#a6e22e">rasterGrob</span>(img, interpolate<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  PLOT <span style="color:#f92672">=</span> PLOT <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotation_custom</span>(grob<span style="color:#f92672">=</span>g[[i]], xmin<span style="color:#f92672">=</span>i<span style="color:#ae81ff">-.5</span>, xmax<span style="color:#f92672">=</span>i<span style="color:#ae81ff">+.5</span>, ymin<span style="color:#f92672">=</span>DATA<span style="color:#f92672">$</span>values[i], ymax<span style="color:#f92672">=</span>DATA<span style="color:#f92672">$</span>values[i]<span style="color:#ae81ff">+10</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-12-1.png" alt=""><!-- --></p>
<p>That looks fun! It&rsquo;s like brains popping out of chimneys :D But some of the top brains are cropped. Poor brains! Easy enough to fix by scaling the Y, so that it doesn&rsquo;t stop at 100, but maybe 110.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_continuous</span>(limits<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">0</span>,<span style="color:#ae81ff">110</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-13-1.png" alt=""><!-- --></p>
<p>Nice! I&rsquo;m pretty happy with that for a fun plot. But I wouldn&rsquo;t necessarily submit that to a fancy academic journal, where even colours are a stretch. For something like that, i&rsquo;d put the brains below the bars, which we can easily do!</p>
<p>In this case, I&rsquo;ll use ggplot built-in <code>Inf</code> notation, which gives you the edge of the plotting area. This is very convenient. <code>Inf</code> on the x-axis signifies the right-hand boundary, while <code>-Inf</code> is the left-hand one. For Y, they are the top and bottom, respectively. I only need to y in this case.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">=</span> <span style="color:#a6e22e">ggplot</span>(DATA) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>) 
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(DATA)){
</span></span><span style="display:flex;"><span>  img <span style="color:#f92672">=</span> <span style="color:#a6e22e">readPNG</span>(DATA<span style="color:#f92672">$</span>images[i])
</span></span><span style="display:flex;"><span>  g[[i]] <span style="color:#f92672">=</span>  <span style="color:#a6e22e">rasterGrob</span>(img, interpolate<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  PLOT <span style="color:#f92672">=</span> PLOT <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotation_custom</span>(grob<span style="color:#f92672">=</span>g[[i]], xmin<span style="color:#f92672">=</span>i<span style="color:#ae81ff">-.5</span>, xmax<span style="color:#f92672">=</span>i<span style="color:#ae81ff">+.5</span>, ymin<span style="color:#f92672">=-</span><span style="color:#66d9ef">Inf</span>, ymax<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-14-1.png" alt=""><!-- --></p>
<p>right-o! It&rsquo;s a little crowded though. Let&rsquo;s reduce the plot to the ones where the value exceeds 60, let&rsquo;s pretend that&rsquo;s some magic significance threshold.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(tidyverse)
</span></span></code></pre></div><pre tabindex="0"><code>## ── Attaching packages ───────────────────────────────────────────────────── tidyverse 1.3.0 ──
</code></pre><pre tabindex="0"><code>## ✓ tibble  3.0.1     ✓ dplyr   0.8.5
## ✓ tidyr   1.0.3     ✓ stringr 1.4.0
## ✓ readr   1.3.1     ✓ forcats 0.5.0
## ✓ purrr   0.3.4
</code></pre><pre tabindex="0"><code>## ── Conflicts ──────────────────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>Data_reduced <span style="color:#f92672">=</span> DATA <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">filter</span>(values <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">60</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLOT <span style="color:#f92672">=</span> <span style="color:#a6e22e">ggplot</span>(Data_reduced) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">geom_histogram</span>(<span style="color:#a6e22e">aes</span>(x<span style="color:#f92672">=</span>names, y<span style="color:#f92672">=</span>values), stat<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;identity&#34;</span>) 
</span></span></code></pre></div><pre tabindex="0"><code>## Warning: Ignoring unknown parameters: binwidth, bins, pad
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>g <span style="color:#f92672">=</span> <span style="color:#a6e22e">list</span>()
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">for</span>(i in <span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#a6e22e">nrow</span>(Data_reduced)){
</span></span><span style="display:flex;"><span>  img <span style="color:#f92672">=</span> <span style="color:#a6e22e">readPNG</span>(Data_reduced<span style="color:#f92672">$</span>images[i])
</span></span><span style="display:flex;"><span>  g[[i]] <span style="color:#f92672">=</span>  <span style="color:#a6e22e">rasterGrob</span>(img, interpolate<span style="color:#f92672">=</span><span style="color:#66d9ef">TRUE</span>)
</span></span><span style="display:flex;"><span>  
</span></span><span style="display:flex;"><span>  PLOT <span style="color:#f92672">=</span> PLOT <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">annotation_custom</span>(grob<span style="color:#f92672">=</span>g[[i]], xmin<span style="color:#f92672">=</span>i<span style="color:#ae81ff">-.5</span>, xmax<span style="color:#f92672">=</span>i<span style="color:#ae81ff">+.5</span>, ymin<span style="color:#f92672">=-</span><span style="color:#66d9ef">Inf</span>, ymax<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-15-1.png" alt=""><!-- --></p>
<p>hmmm. The brains are still teeny-tiny! That&rsquo;s becasue the plotting area between <code>-Inf</code>  and 0 is a constant, and is determined by ggplot to make it pretty. Thankfully, all we need to do is to make the y-limits go into the negative values to increase the image size. Because ymin of the images are bound to <code>-Inf</code> their bottom will follow the scale of the plot!</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>PLOT <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">theme</span>(axis.text.x <span style="color:#f92672">=</span> <span style="color:#a6e22e">element_text</span>(angle<span style="color:#f92672">=</span><span style="color:#ae81ff">60</span>, vjust<span style="color:#f92672">=</span><span style="color:#ae81ff">-.001</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_y_continuous</span>(limits<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#ae81ff">-10</span>,<span style="color:#ae81ff">100</span>))
</span></span></code></pre></div><p><img src="index_files/figure-html/unnamed-chunk-16-1.png" alt=""><!-- --></p>
<p>That&rsquo;s how I add images to my plots! In a later post, I hope to introduce you to adding images to other types of plots, like circle plots and networks.</p>
<p>And if you have suggestions for improvement of this procedure, don&rsquo;t hesitate to let me know!</p>

        </div>
    </article><div class="uk-margin">
    <button  class="uk-button uk-button-default" uk-toggle="target: #citation; animation: uk-animation-fade" type="button">
        Cite me!
    </button>
    <div id="citation" hidden class="uk-margin">
        <div uk-grid class="uk-child-width-1-2@s">
            <div>
                For attribution, please cite this work as
                <div class="uk-card uk-card-default uk-card-bod uk-text-breaky">
                    DrMowinckels 
                    (May 7, 2018) 
                    Adding external images to plots. 
                    Retrieved from https://drmowinckels.io/blog/2018/adding-external-images-to-plots/.
                     DOI: https://www.doi.org/10.5281/zenodo.13271538
                </div>
            </div>
            <div>
                <b>BibTeX citation</b>
                <div class="uk-card uk-card-default uk-card-body uk-text-break">
                    @misc{ <br>
                        2018-adding-external-images-to-plots,<br>
                        &emsp;author =  "DrMowinckels",<br>
                        &emsp;title = "Adding external images to plots",<br>
                        &emsp;url = "https://drmowinckels.io/blog/2018/adding-external-images-to-plots/",<br>
                        &emsp;year = 2018,<br>
                         &emsp;doi = "https://www.doi.org/10.5281/zenodo.13271538",<br> 
                        &emsp;updated = "Oct 7, 2024"<br>
                    }
                </div>
            </div>
        </div>
    </div>
</div><div class="uk-grid uk-child-width-expand@s uk-margin-top" uk-grid>
    <div class="uk-width-expand">
        
            <a class="uk-button uk-button-default" href="https://drmowinckels.io/blog/2018/gamm-random-effects/">
                <span class="uk-margin-small-left" uk-icon="chevron-double-left"></span>
                GAMM random effects
            </a>
        
    </div>
    
    <div class="uk-width-auto">
        
            <a class="uk-button uk-button-default" href="https://drmowinckels.io/blog/2018/circluar-plots-in-r-and-adding-images/">
                Circular plots in R and adding images
                <span class="uk-margin-small-right" uk-icon="chevron-double-right"></span>
            </a>
        
    </div>
</div>

    
    
        <div class="uk-container uk-margin-top">
            <script src="https://giscus.app/client.js"
                data-repo=DrMowinckels/drmowinckels.github.io
                data-repo-id=MDEwOlJlcG9zaXRvcnkxMjM0NzEwMTI&#61;
                data-category=Comments
                data-category-id=DIC_kwDOB1wEpM4CAG0c
                data-mapping=pathname
                data-reactions-enabled=1
                data-emit-metadata=0
                data-theme=light
                data-lang=en
                crossorigin="anonymous"
                async>
            </script>
</div>

    

        </div><div class="section uk-section uk-padding-remove-vertical uk-margin">
    <div class="banner footer" height="500px">
        <div class="uk-container">
            <div class="uk-grid" uk-grid>
                <div class="uk-width-1-2@m">
                    
                      <h3><i class="fa-regular fa-copyright"></i> 2023 Athanasia Mo Mowinckel</h3>
                      <p></p>
                    
                  </div>
              <div class="uk-width-1-2@m">
                
              </div>
            </div>
          </div>
          <div class="footer-title uk-text-right">
            <h1>Dr. Mowinckel&rsquo;s</h1>
        </div>
    </div>
</div>
</body>
</html>
