<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/>


<title>Get the brain animated! - Dr. Mowinckel&#39;s</title>


<meta name="hugo-igloo" />




  <meta name="description" content="Explore how to create animated visualizations of brain data using the ggseg and gganimate packages in R. Learn to prepare data for animations, customize plots, and generate smooth transitions to visualize changes across different conditions such as age." />
  <meta name="author" content="DrMowinckels" />






<meta name="generator" content="Hugo 0.138.0">



        


<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Create animated brain data visualizations in R using ggseg and gganimate. Learn data preparation, plot customization, and generating animations with smooth transitions.">


<meta prefix="og: http://ogp.me/ns#" property="og:url" content="https://drmowinckels.io/blog/2018/get-the-brain-animated/">
<meta prefix="og: http://ogp.me/ns#" property="og:type" content="website">
<meta prefix="og: http://ogp.me/ns#" property="og:title" content="Get the brain animated! - Dr. Mowinckel&rsquo;s">
<meta prefix="og: http://ogp.me/ns#" property="og:description" content="Create animated brain data visualizations in R using ggseg and gganimate. Learn data preparation, plot customization, and generating animations with smooth transitions.">


<meta name="twitter:card" content="summary_large_image">
<meta property="twitter:domain" content="https://drmowinckels.io/blog/2018/get-the-brain-animated/">
<meta name="twitter:title" content="Igloo">
<meta name="twitter:description" content="Create animated brain data visualizations in R using ggseg and gganimate. Learn data preparation, plot customization, and generating animations with smooth transitions.">



    <meta prefix="og: http://ogp.me/ns#" property="og:image" content="https://drmowinckels.io/blog/2018/get-the-brain-animated/index_files/figure-html/featured-1.gif" />
    <meta name="twitter:image" content="https://drmowinckels.io/blog/2018/get-the-brain-animated/index_files/figure-html/featured-1.gif">



        
  





    



 

    <link rel="stylesheet" href="https://drmowinckels.io/bundle.min.baa1908f96e0c6f9b71447b145d29e168c7a152baf3ed19c88d9c64d40abd901.css" 
    integrity="sha256-uqGQj5bgxvm3FEexRdKeFox6FSuvPtGciNnGTUCr2QE=" 
    crossorigin="anonymous">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" crossorigin="anonymous">


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha384-k6Rqe5g0pSv8V0e6fFfFjW1y77vKTjkE1IUaB+MHUO2GtODX6azbMqa6Y53/zJTU" crossorigin="anonymous">

        
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/night-owl.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>hljs.highlightAll();</script>



    <script src="https://drmowinckels.io/uikit/dist/js/uikit.min.js"></script>


    <script src="https://drmowinckels.io/uikit/dist/js/uikit-icons.min.js"></script>



    <script async data-id="101481527" src="//static.getclicky.com/js"></script>


        



    

    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5366878624836852736.png"
        sizes="16x16"
        type="image/png"
    />
    
    
    
        
        <link rel="shortcut icon" href="https://drmowinckels.io/favicon.ico" type="image/x-icon">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu8517673850517275173.png"
        sizes="32x32"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu14571942087844283845.png"
        sizes="57x57"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu15407313826671950185.png"
        sizes="76x76"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu5243028335169998791.png"
        sizes="96x96"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu12542686187326557868.png"
        sizes="128x128"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu13659698330348218391.png"
        sizes="120x120"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu16981009452699216388.png"
        sizes="150x150"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu7549612530560663352.png"
        sizes="152x152"
        type="image/png"
    />
    
    
    
        <meta name="msapplication-TileImage" 
            content="/img/fav.ico_hu4123736746700774209.png">
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu4123736746700774209.png"
        sizes="144x144"
        type="image/png"
    />
    
    
    
    <link
        rel="apple-touch-icon"
        href="https://drmowinckels.io/img/fav.ico_hu15595176060954391820.png"
        sizes="180x180"
        type="image/png"
    />
    
    
    
    <link
        rel="icon"
        href="https://drmowinckels.io/img/fav.ico_hu15967068578190144734.png"
        sizes="192x192"
        type="image/png"
    />
    
    
    
    <link
        rel="shortcut icon"
        href="https://drmowinckels.io/img/fav.ico_hu7854817480044023005.png"
        sizes="196x196"
        type="image/png"
    />
<meta name="msapplication-TileColor" content="#198c8c">
<meta name="theme-color" content="#198c8c"> 
<meta name="msapplication-TileColor" content="#198c8c">

    </head>
    <body>
            
<div class="banner ">
    
        <div class="uk-container uk-container-small banner-top">
            <h1>blog</h1>
        </div>
    
</div>

        



<div id="smallnav" uk-offcanvas="flip: true" class="uk-offcanvas">
    <div class="uk-offcanvas-bar">
        <ul class="uk-nav">
            
                <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                    <img src="https://drmowinckels.io/img/logo.png" width="40">
                </a> 
            
            
                <li>
                    <a href="https://drmowinckels.io/about">
                        About
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/blog">
                        Blog
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/talks">
                        Talks
                        
                    </a>
                    
                </li>
            
                <li>
                    <a href="https://drmowinckels.io/projects">
                        Projects
                        
                    </a>
                    
                </li>
            
        </ul>
    </div>
</div>
<a class="uk-navbar-container uk-navbar-left uk-navbar-toggle uk-hidden@s" uk-toggle="target: #smallnav" uk-navbar-toggle-icon></a>

<div class="uk-visible@s" uk-sticky="sel-target: .uk-navbar-container; cls-active: uk-navbar-sticky">
    <nav class="uk-navbar-container">   
        <div uk-navbar>     
            <div class="uk-navbar-center">
                
                    
                        <div class="uk-navbar-center-left">
                            <ul class="uk-navbar-nav">
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/about">
                            About
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/blog">
                            Blog
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
                    
                    
                        
                            <a class="uk-navbar-item uk-logo" href="https://drmowinckels.io/">
                                <img src="https://drmowinckels.io/img/logo.png" width="40">
                            </a> 
                        
                        <div class="uk-navbar-center-right">
                            <ul class="uk-navbar-nav"> 
                    
                    <li>
                        <a href="https://drmowinckels.io/talks">
                            Talks
                            
                        </a>
                        
                    </li>
                    
                
                    
                    
                    <li>
                        <a href="https://drmowinckels.io/projects">
                            Projects
                            
                        </a>
                        
                    </li>
                    
                            </ul>
                        </div>
                    
                
            </div>
        </div>
    </nav>
</div>


        <div id="content" class="uk-container uk-container-small uk-margin-large-top">
    <article class="uk-article">
        <div class="uk-grid uk-flex-top" uk-grid>
            
            
            <div class="uk-width-1-4@s">
              <img src="https://drmowinckels.io/blog/2018/get-the-brain-animated/index_files/figure-html/featured-1.gif" alt="Get the brain animated!" class="uk-border-rounded">
              
            </div>

        <div class="uk-width-3-4@s">
        <h1 class="uk-article-title">Get the brain animated!</h1>
        
        <div class="uk-border-top uk-article-meta uk-flex uk-flex-center uk-flex-between">
            <h3 class="uk-margin-top-small">
                Oct 1, 2018
            </h3>
            

            
                <div class="uk-flex uk-flex-wrap uk-flex-right">
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/packages/" class="uk-label uk-label-secondary tags" >
                                Packages
                            </a>
                        </div>
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/neuroimaging/" class="uk-label uk-label-secondary tags" >
                                Neuroimaging
                            </a>
                        </div>
                    
                        
                        
                        
                        
                        
                        <div class="uk-card uk-margin-left uk-margin-bottom">
                            <a href="https://drmowinckels.io/tags/r/" class="uk-label uk-label-secondary tags" >
                                R
                            </a>
                        </div>
                    
                </div>
            
        </div>
    </div>
        <div id="offcanvas-reveal" uk-offcanvas="mode: reveal; overlay: true">
            <div class="uk-offcanvas-bar">
                <button class="uk-offcanvas-close" type="button" uk-close></button>
                <h3>Table of Content</h3>
                <nav id="TableOfContents"></nav>
            </div>
        </div>
        
            <p class="uk-text-lead">Explore how to create animated visualizations of brain data using the ggseg and gganimate packages in R. Learn to prepare data for animations, customize plots, and generate smooth transitions to visualize changes across different conditions such as age.</p>
        
        <div class="uk-markdown uk-width">
            <p>I&rsquo;m super delighted that our ggseg package was so well received! We almost immediately got it on <a href="https://neuroconductor.org/">Neuroconductor</a>, which is a neuroimaging equivalent to Bioconductor. We got some pull requests from people helping us improve the code, and particularly get it ready for CRAN when we decide to submit it there.</p>
<p>In all of this, I learned so much about creating packages, and ended up making quite a major alteration to the base-functions of the package. I had not completely understood the use and the ellipsis (<code>...</code>) and as such had not used it correctly. Once I started understanding it, we could make the package working closer to what a standard ggplot package would work!</p>
<p>The package vignettes are update on the new usage, which mainly affects how you may supply data for facetting. Just have a look at  <code>vignette(&quot;ggseg&quot;)</code> and <code>vignette(&quot;externalData&quot;)</code> for a more up-to-date understanding of how the data should look.</p>
<p>And this post will use the technique necessary for facetting, just for making animations with the <a href="https://github.com/thomasp85/gganimate">gganimate</a> package instead. This package is so clever, and I am in complete awe of Thomas&rsquo; brilliance in making it. Especially the new development version, which has altered the way to use the package that falls completely in-line with the rest of the ggplot-idea.</p>
<p>Let&rsquo;s fabricate some data to work with. I want to plot the Desikan-Killany atlas, with information for mean values of thickness across different ages. Since I&rsquo;m completely making all this data up, I&rsquo;ll just start with the <code>dk</code> data.frame that comes with the package, grabs its unique instances of region and hemisphere (which gives me every region in the dk atlas), and start making up some cortical thickness values per age.</p>
<p>Grab the unique polygons</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>base_atlas <span style="color:#f92672">=</span> dk <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">select</span>(region, hemi) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">distinct</span>() <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">na.omit</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>base_atlas <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">head</span>(<span style="color:#ae81ff">5</span>)
</span></span></code></pre></div><pre tabindex="0"><code>## # A tibble: 5 x 2
##   region                hemi 
##   &lt;chr&gt;                 &lt;chr&gt;
## 1 bankssts              left 
## 2 caudal middle frontal left 
## 3 fusiform              left 
## 4 inferior parietal     left 
## 5 inferior temporal     left
</code></pre><p>Make up some cortical thickness values given an age</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>new_data <span style="color:#f92672">=</span> base_atlas <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">mutate</span>(Age<span style="color:#f92672">=</span><span style="color:#ae81ff">7</span>,
</span></span><span style="display:flex;"><span>         thickness <span style="color:#f92672">=</span> <span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">.001</span>), <span style="color:#a6e22e">nrow</span>(.)))
</span></span></code></pre></div><p>Lets plot it to have a looksie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>new_data <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggseg</span>(mapping<span style="color:#f92672">=</span><span style="color:#a6e22e">aes</span>(fill<span style="color:#f92672">=</span>thickness), position<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stacked&#34;</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradientn</span>(colours<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dodgerblue4&#34;</span>,<span style="color:#e6db74">&#34;light blue&#34;</span>,<span style="color:#e6db74">&#34;firebrick&#34;</span>,<span style="color:#e6db74">&#34;goldenrod&#34;</span>))
</span></span></code></pre></div><p><img class="uk-thumbnail" src="index_files/figure-html/unnamed-chunk-3-1.png"
    
    ><!-- --></p>
<p>ok, so that looks pretty decent. Notice that I&rsquo;ve included some extra aestetics to make it look nice. I&rsquo;ve added <code>colour</code> to provide definition between the cortical parcellations, and made sure the <code>size</code> of this line is thin.</p>
<p>So, now I want to do the same thing, just for many different age groups.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Make a list of all the age groups</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> <span style="color:#a6e22e">sapply</span>(<span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">40</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>), list)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(full_data) <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">40</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apply through the list to fabricate data per age.</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> <span style="color:#a6e22e">lapply</span>(full_data, 
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">function</span>(x)  
</span></span><span style="display:flex;"><span>         base_atlas <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">mutate</span>(Age<span style="color:#f92672">=</span>x[1],
</span></span><span style="display:flex;"><span>                thickness <span style="color:#f92672">=</span> <span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">.001</span>), <span style="color:#a6e22e">nrow</span>(.))))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Bind the data together.</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> full_data <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">bind_rows</span>()
</span></span></code></pre></div><p>Now we should have a data frame with values for each region and hemisphere across the ages 5-40.
Let&rsquo;s have a look at how it looks when we facet it.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>full_data <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggseg</span>(mapping<span style="color:#f92672">=</span><span style="color:#a6e22e">aes</span>(fill<span style="color:#f92672">=</span>thickness), position<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stacked&#34;</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradientn</span>(colours<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dodgerblue4&#34;</span>,<span style="color:#e6db74">&#34;light blue&#34;</span>,<span style="color:#e6db74">&#34;firebrick&#34;</span>,<span style="color:#e6db74">&#34;goldenrod&#34;</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>Age)
</span></span></code></pre></div><p><img class="uk-thumbnail" src="index_files/figure-html/unnamed-chunk-5-1.png"
    
    ><!-- --></p>
<p>Hm, there is something a little off here. The medial wall is omitted from all facets, and is placed in it&rsquo;s own facet!
This is expected behaviour as of the new <code>ggseg</code> version.</p>
<p>If you want to facet, you&rsquo;ll need to make sure each facet includes information for <em>all regions</em>  even if these regions don&rsquo;t have any aestetics value (in this case a thickness value we are plotting as fill).</p>
<p>To manage this, we need to go back a step when we made the data.frame, and merge our fabricated data with the entire <code>dk</code> atlas.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Make a list of all the age groups</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> <span style="color:#a6e22e">sapply</span>(<span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">40</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>), list)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">names</span>(full_data) <span style="color:#f92672">=</span> <span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">40</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># apply through the list to fabricate data per age, and add dk atlas</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> <span style="color:#a6e22e">lapply</span>(full_data, 
</span></span><span style="display:flex;"><span>       <span style="color:#66d9ef">function</span>(x)  
</span></span><span style="display:flex;"><span>         base_atlas <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">mutate</span>(thickness <span style="color:#f92672">=</span> <span style="color:#a6e22e">sample</span>(<span style="color:#a6e22e">seq</span>(<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">5</span>,by<span style="color:#f92672">=</span><span style="color:#ae81ff">.001</span>), <span style="color:#a6e22e">nrow</span>(.))) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">full_join</span>(dk) <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>         <span style="color:#a6e22e">mutate</span>(Age<span style="color:#f92672">=</span>x[1])
</span></span><span style="display:flex;"><span>         )
</span></span></code></pre></div><pre tabindex="0"><code>## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
## Joining, by = c(&#34;region&#34;, &#34;hemi&#34;)
</code></pre><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#75715e"># Bind the data together.</span>
</span></span><span style="display:flex;"><span>full_data <span style="color:#f92672">=</span> full_data <span style="color:#f92672">%&gt;%</span> <span style="color:#a6e22e">bind_rows</span>()
</span></span></code></pre></div><p>You see how we&rsquo;ve been informed that the data have been joined by <code>hemi</code> and <code>region</code>, which is exactly what we want. Let&rsquo;s see what it looks like now.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span>full_data <span style="color:#f92672">%&gt;%</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">ggseg</span>(mapping<span style="color:#f92672">=</span><span style="color:#a6e22e">aes</span>(fill<span style="color:#f92672">=</span>thickness), position<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stacked&#34;</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradientn</span>(colours<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dodgerblue4&#34;</span>,<span style="color:#e6db74">&#34;light blue&#34;</span>,<span style="color:#e6db74">&#34;firebrick&#34;</span>,<span style="color:#e6db74">&#34;goldenrod&#34;</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>Age)
</span></span></code></pre></div><p><img class="uk-thumbnail" src="index_files/figure-html/unnamed-chunk-7-1.png"
    
    ><!-- --></p>
<p>Even more crazy! But again, this is expected behaviour. You see, we have supplied an entire atlas of information to ggseg, which again tries to mege it with (in this case)  the dk atlas. That makes this odd behaviour.</p>
<p>To plot this as we want, we need to tell <code>ggseg</code> that we are supplying a new <code>atlas</code> <strong>not</strong> new data.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">ggseg</span>(atlas<span style="color:#f92672">=</span>full_data, mapping<span style="color:#f92672">=</span><span style="color:#a6e22e">aes</span>(fill<span style="color:#f92672">=</span>thickness), position<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stacked&#34;</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradientn</span>(colours<span style="color:#f92672">=</span><span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dodgerblue4&#34;</span>,<span style="color:#e6db74">&#34;light blue&#34;</span>,<span style="color:#e6db74">&#34;firebrick&#34;</span>,<span style="color:#e6db74">&#34;goldenrod&#34;</span>)) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">facet_wrap</span>(<span style="color:#f92672">~</span>Age)
</span></span></code></pre></div><p><img class="uk-thumbnail" src="index_files/figure-html/unnamed-chunk-8-1.png"
    
    ><!-- --></p>
<p>Right-o! Now we&rsquo;re cookin&rsquo;! Now that we&rsquo;ve established that our data is good for faceting, this means it is also good for animating.</p>
<p>You&rsquo;ll need to install the gganimate package from github to get this working and also install the package <code>transformr</code> from the same author, as we are working with polygons.</p>
<p>While I am still far from comfortable with gganimate (I struggle to control speed and types of transitions), it is pretty easy to get an animation going. Disclaimer here: this data is quite rich, so you&rsquo;ll need patienence for the animation to render.</p>
<p>We use the same bare plot as before, but substitute the facet with a transition. The transition here you provide with the variable that contains the different transitions, and information about the transition length and state length, which I am more unsure of. At the end, we&rsquo;ll make sure the title of the plot corresponds with the age currently displaying, with some more <code>gganimate</code> magic.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(gganimate)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">library</span>(transformr)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>t <span style="color:#f92672">=</span> <span style="color:#a6e22e">ggseg</span>(atlas<span style="color:#f92672">=</span>full_data, 
</span></span><span style="display:flex;"><span>          mapping<span style="color:#f92672">=</span><span style="color:#a6e22e">aes</span>(fill<span style="color:#f92672">=</span>thickness), 
</span></span><span style="display:flex;"><span>          position<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stacked&#34;</span>, colour<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;darkgrey&#34;</span>) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scale_fill_gradientn</span>(
</span></span><span style="display:flex;"><span>    colours <span style="color:#f92672">=</span> <span style="color:#a6e22e">c</span>(<span style="color:#e6db74">&#34;dodgerblue4&#34;</span>,<span style="color:#e6db74">&#34;light blue&#34;</span>,<span style="color:#e6db74">&#34;firebrick&#34;</span>,<span style="color:#e6db74">&#34;goldenrod&#34;</span>)
</span></span><span style="display:flex;"><span>    ) <span style="color:#f92672">+</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">transition_states</span>(Age, <span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">labs</span>(title <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;Age: {closest_state}&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># This last part is just to control the output in this blog, which was rendering the gif too slow by default</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">animate</span>(t, fps <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>) 
</span></span></code></pre></div><figure class="uk-thumbnail">
        <img src="index_files/figure-html/featured-1.gif" 
        >
        
    </figure><p>and there you go! A pretty animation of the data! To understand the arguments to gganimate, I guess the best way to get a feel for it is to just play around with it. Now, I have to admit, that I am a little frustrated by the the gif is shown here on the blog, as in the RStudio viewer it looks awesome, with nice smooth transitions between states (here: Ages), but it is rendered here with very stacatto transitions.</p>
<p>I&rsquo;m giving up a little fixing this issue for now, and hope I&rsquo;ll manage a better integration of gifs on the blog in the future.</p>
<p>Happy plotting!</p>
<p><em>Edit: This post was edited May 1st 2020 to reflect newer package changes</em></p>

        </div>
    </article><div class="uk-margin">
    <button  class="uk-button uk-button-default" uk-toggle="target: #citation; animation: uk-animation-fade" type="button">
        Cite me!
    </button>
    <div id="citation" hidden class="uk-margin">
        <div uk-grid class="uk-child-width-1-2@s">
            <div>
                For attribution, please cite this work as
                <div class="uk-card uk-card-default uk-card-bod uk-text-breaky">
                    DrMowinckels 
                    (Oct 1, 2018) 
                    Get the brain animated!. 
                    Retrieved from https://drmowinckels.io/blog/2018/get-the-brain-animated/.
                     DOI: https://www.doi.org/10.5281/zenodo.13273462
                </div>
            </div>
            <div>
                <b>BibTeX citation</b>
                <div class="uk-card uk-card-default uk-card-body uk-text-break">
                    @misc{ <br>
                        2018-get-the-brain-animated,<br>
                        &emsp;author =  "DrMowinckels",<br>
                        &emsp;title = "Get the brain animated!",<br>
                        &emsp;url = "https://drmowinckels.io/blog/2018/get-the-brain-animated/",<br>
                        &emsp;year = 2018,<br>
                         &emsp;doi = "https://www.doi.org/10.5281/zenodo.13273462",<br> 
                        &emsp;updated = "Oct 8, 2025"<br>
                    }
                </div>
            </div>
        </div>
    </div>
</div><div class="section" style="height: auto !important;">
        <div class="uk-section">
            
            <div class="uk-position-relative uk-visible-toggle uk-light timeline-horizontal" tabindex="-1" uk-slider="clsActivated: uk-transition-active; center: true">

                <ul class="uk-slider-items uk-grid" >
                    
                    
                        <li class="uk-width-3-4" >
                            <div class="timeline-item timeline-item-horizontal">
  

  
  <div class="timeline-date">
    Aug 30, 2018
  </div>

  <div class="timeline-dot"></div>
  <div class="timeline-content">
      
      

      
      
      
        
          
        
      
      
      
      
    <h2>Introducing the ggseg R-package for brain segmentations</h2>
    
      <p>Discover ggseg, an R package designed for plotting brain segmentations directly in R with ggplot2. Learn how to visualize results from different brain atlases, customize plots, and integrate your own data. Ideal for neuroimaging researchers needing to plot segmented brain data efficiently.</p>
    
    <div class="uk-flex uk-flex-between uk-flex-middle ">
      
        <a class="btn-more" href="https://drmowinckels.io/blog/2018/introducing-the-ggseg-r-package-for-brain-segmentations/">
          Read
        </a>
      
    
      
        <span class="uk-text-right">
          
           
            
                <div class="uk-label timeline-tags">plots</div>
            
          
           
            
                <div class="uk-label timeline-tags">packages</div>
            
          
           
            
                <div class="uk-label timeline-tags">neuroimaging</div>
            
          
           
            
                <div class="uk-label timeline-tags">r</div>
            
          
        </span>
      
    </div>
  </div>
</div> 
                        </li>
                    
                    
                        <li class="uk-width-3-4" >
                            <div class="timeline-item timeline-item-horizontal">
  

  
  <div class="timeline-date">
    May 25, 2018
  </div>

  <div class="timeline-dot"></div>
  <div class="timeline-content">
      
      

      
      
      
        
          
        
      
      
      
      
    <h2>Circular plots in R and adding images</h2>
    
    <div class="uk-flex uk-flex-between uk-flex-middle ">
      
        <a class="btn-more" href="https://drmowinckels.io/blog/2018/circluar-plots-in-r-and-adding-images/">
          Read
        </a>
      
    
      
        <span class="uk-text-right">
          
           
            
                <div class="uk-label timeline-tags">plots</div>
            
          
           
            
                <div class="uk-label timeline-tags">neuroimaging</div>
            
          
           
            
                <div class="uk-label timeline-tags">r</div>
            
          
        </span>
      
    </div>
  </div>
</div> 
                        </li>
                    
                    
                        <li class="uk-width-3-4" >
                            <div class="timeline-item timeline-item-horizontal">
  

  
  <div class="timeline-date">
    May 07, 2018
  </div>

  <div class="timeline-dot"></div>
  <div class="timeline-content">
      
      

      
      
      
        
          
        
      
      
      
      
    <h2>Adding external images to plots</h2>
    
      <p>Learn how to add external images to your ggplot visualizations in R. This tutorial covers steps to read images and plot them alongside your data, useful for enhancing interpretation and presentation in fields like neuroimaging. Discover how to use functions like <code>readPNG</code>, <code>rasterGrob</code>, and <code>annotation_custom</code> for integrating images with your plots.</p>
    
    <div class="uk-flex uk-flex-between uk-flex-middle ">
      
        <a class="btn-more" href="https://drmowinckels.io/blog/2018/adding-external-images-to-plots/">
          Read
        </a>
      
    
      
        <span class="uk-text-right">
          
           
            
                <div class="uk-label timeline-tags">r</div>
            
          
        </span>
      
    </div>
  </div>
</div> 
                        </li>
                    
                    
                        <li class="uk-width-3-4" >
                            <div class="timeline-item timeline-item-horizontal">
  

  
  <div class="timeline-date">
    Apr 05, 2018
  </div>

  <div class="timeline-dot"></div>
  <div class="timeline-content">
      
      

      
      
      
        
          
        
      
      
      
      
    <h2>GAMM random effects</h2>
    
      <p>Explore the use of Generalized Additive Mixed Models (GAMMs) with random effects using <code>mgcv</code> in R. This blog post covers the differences between specifying random effects in <code>mgcv</code> compared to other packages like <code>lme4</code> and walks through a detailed example with simulated data. Learn about <code>gamm</code> model output, interpreting random effects, and plot comparisons of different model specifications.</p>
    
    <div class="uk-flex uk-flex-between uk-flex-middle ">
      
        <a class="btn-more" href="https://drmowinckels.io/blog/2018/gamm-random-effects/">
          Read
        </a>
      
    
      
        <span class="uk-text-right">
          
           
            
                <div class="uk-label timeline-tags">r</div>
            
          
           
            
                <div class="uk-label timeline-tags">gamm</div>
            
          
        </span>
      
    </div>
  </div>
</div> 
                        </li>
                    
                    
                        <li class="uk-width-3-4" >
                            <div class="timeline-item timeline-item-horizontal">
  

  
  <div class="timeline-date">
    Mar 08, 2018
  </div>

  <div class="timeline-dot"></div>
  <div class="timeline-content">
      
      

      
      
      
        
          
        
      
      
      
      
    <h2>GAMM spaghetti plots in R with ggplot</h2>
    
      <p>Discover how to plot Generalized Additive Mixed Models (GAMMs) using ggplot2 in R. This tutorial covers generating simulated data, creating GAMM models with mgcv, predicting single predictor effects, and using the itsadug package for smooth predictions. Learn the steps to visualize complex models and create informative plots.</p>
    
    <div class="uk-flex uk-flex-between uk-flex-middle ">
      
        <a class="btn-more" href="https://drmowinckels.io/blog/2018/gamm-spaghetti-plots-in-r-with-ggplot/">
          Read
        </a>
      
    
      
        <span class="uk-text-right">
          
           
            
                <div class="uk-label timeline-tags">r</div>
            
          
           
            
                <div class="uk-label timeline-tags">gamm</div>
            
          
        </span>
      
    </div>
  </div>
</div> 
                        </li>
                    
                </ul>
            
                <a class="uk-position-center-left uk-position-small slide-nav-primary" href uk-slidenav-previous uk-slider-item="previous"></a>
                <a class="uk-position-center-right uk-position-small slide-nav-primary" href uk-slidenav-next uk-slider-item="next"></a>
            
            </div>
        </div>
    </div>
    
        <div class="uk-container uk-margin-top">
            <script src="https://giscus.app/client.js"
                data-repo=DrMowinckels/drmowinckels.github.io
                data-repo-id=MDEwOlJlcG9zaXRvcnkxMjM0NzEwMTI&#61;
                data-category=Comments
                data-category-id=DIC_kwDOB1wEpM4CAG0c
                data-mapping=pathname
                data-reactions-enabled=1
                data-emit-metadata=0
                data-theme=light
                data-lang=en
                crossorigin="anonymous"
                async>
            </script>
</div>

    

        </div><div class="section uk-section uk-padding-remove-vertical uk-margin">
    <div class="banner footer" height="500px">
        <div class="uk-container">
            <div class="uk-grid" uk-grid>
                <div class="uk-width-1-2@m">
                    
                      <h3><i class="fa-regular fa-copyright"></i> 2023 Athanasia Mo Mowinckel</h3>
                      <p></p>
                    
                  </div>
              <div class="uk-width-1-2@m">
                
              </div>
            </div>
          </div>
          <div class="footer-title uk-text-right">
            <h1>Dr. Mowinckel&rsquo;s</h1>
        </div>
    </div>
</div>


</body>
</html>
